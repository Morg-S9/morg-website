<!DOCTYPE html>
<html>

	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>July 29th, 2021</title>
		<link rel="icon" type="image/png" href="/favicon.png">
		<link href='https://fonts.googleapis.com/css?family=Aldrich' rel='stylesheet'>
		<link rel="stylesheet" type="text/css" href="stylesheet.css">
		<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyAkuT_HgZ1EZFAuvODvWRKvDr4jMpXthJ0",
    authDomain: "morg-s-website.firebaseapp.com",
    projectId: "morg-s-website",
    storageBucket: "morg-s-website.appspot.com",
    messagingSenderId: "584356221248",
    appId: "1:584356221248:web:d9482dcae7273671f4aaa5",
    measurementId: "G-HTPFCSFFLK"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
		</script>
		
	</head>

	<body>
		<h1>July 29th, 2021</h1>
		<p>Hello everyone! I hope you all are doing well.</p>
		<p>I made a Discord Webhook Script for you to use today!</p>
		<p>This script is for the people out there who play on the Minecraft Anarchy Server, 2b2t.org!</p>
		<p>A bit of backstory, 2b2t is a Minecraft Server with virtually no rules (therefore coined, an anarchy server.)</p>
		<p>Ever since 2016, due to the massive influx of players, 2b2t has added a queue system. This queue is usually very large, and at one point, had almost 2.4k players waiting in it!</p>
		<p>Now obviously, not everyone is willing to wait that long, therefore, there is a Priority Queue!</p>
		<p>How it works is that if you pay a certain amount a month, you have access to a queue that has priority over the normal one, and therefore, you don't have to wait as long!</p>
		<p>Anyway, back to the script.</p>
		<p>This script is rather simple. All it does is output the queue status of both the normal and priority queue (via the 2b2t.io API) to a Discord Webhook!</p> 
		<p>It's set to do it on loop every 10 minutes, but it is possible to change the wait time. More on that later, though.</p>
		<p>Discord Webhooks are a way to interact with a Discord Server via WebAPI Calls. The feature we will be taking advantage of is the ability to send messages with it.</p>
		<p>Note that this script was written with Ubuntu-Linux Based Distros, and Raspbian Linux in mind. It may work with other Linux Distros, but I haven't tested.</p>
		<p>So without further adieu, let's get to how to use it!</p>
		<br>
		<h2>Section One: Discord Prerequisites</h2>
		<p>Open your Discord Server, and find the channel you wish to have the bot output to.</p>
		<p>Open it's settings and click "Integrations".</p>
		<img src="images/integrations.png" alt="Intergrations Button">
		<br>
		<p>Click "Create Webhook"</p>
		<img src="images/webhooks.png" alt="Create Webhook Button">
		<br>
		<p>Give your webhook a name, and image, then click "Save changes" at the bottom of the screen.</p>
		<img src="images/imageandname.png" alt="Webhook Image and Name Setting">
		<br>
		<p>Click "Copy Webhook URL"</p>
		<img src="images/webhookurl.png" alt="Copy Webhook URL Button">
		<p>The Webhook API URL will be copied to your clipboard.</p>
		<br>
		<br>
		<h2>Section Two: Server Prerequisites</h2>
		<br>
		<p>Log into your server as the user you wish to run the script under, and update apt</p>
		<code>sudo apt update</code>
		<br>
		<p>Install the following prerequisite programs: jq, cURL, and Screen.</p>
		<code>sudo apt install jq curl screen</code>
		<p>Press <code>Y</code>, then Enter/Return if prompted.</p>
		<br>
		<p>Next, we need to set an environment variable for your Webhook URL.</p>
		<p>Open .bashrc in nano</p>
		<code>nano ~/.bashrc</code>
		<br>
		<p>Scroll to the very bottom of the file and add the following line:</p>
		<code>export twobqwebhook=[webhook url]</code>
		<p>Be sure to replace <code>[webhook url]</code> with your actual Discord Webhook URL. It should be in your clipboard.</p>
		<br>
		<p>Press CTRL+S to save the text file, then CTRL+X to exit Nano.</p>
		<br>
		<p>Restart your server with:</p>
		<code>sudo reboot now</code>
		<br>
		<br>
		<h2>Section 3: Start the script!</h2>
		<br>
		<p>After the server reboots, download the script from <a href="/scripts/dl/2b2tqueuehook.sh">here</a>, or run this command on your server:</p>
		<code>curl -O https://morgs9.xyz/journal/2021-07-29/files/2b2tqueuehook.sh</code>
		<br>
		<p>Open Screen with:</p>
		<code>screen</code>
		<p>If you get the error:</p>
		<code>Directory '/run/screen' must have mode 777.</code>
		<p>Keep scrolling! A fix is below.</p>
		<br>
		<p>Press Enter</p>
		<br>
		<p>Run this command:</p>
		<code>bash 2b2tqueuehook.sh</code>
		<br>
		<p>If you did everything right, you should see the queue status appear in that discord channel!</p>
		<br>
		<p>Finally, press CTRL+A then CTRL+D.</p>
		<p>Done!</p>
		<p>If you wish to stop the script, run the command:</p>
		<code>screen -r</code>
		<p>Then press CTRL+C, then CTRL+D.</p>
		<br>
		<p>Now if you wish to change the time interval between sends, follow along.</p>
		<p>Note that if you set it to go too fast, you might hit the Rate Limit of 2b2t.io's API.</p>
		<br>
		<p>If you haven't already, stop the script with the instructions above.</p>
		<br>
		<p>Open the script in Nano with:</p>
		<code>nano 2b2tqueuehook.sh</code>
		<br>
		<p>Find the line containing:</p>
		<code>sleep 600</code>
		<br>
		<p>Change the 600 to whatever time you want, in seconds.</p>
		<br>
		<p>Press CTRL+S to save, then CTRL+X to exit.</p>
		<br>
		<p>Now use the instructions above to relaunch the script.</p>
		<br>
		<br>
		<p>If you get the error <code>Directory '/run/screen' must have mode 777.</code> when attempting to run screen, run this command:</p>
		<code>sudo chmod 777 /run/screen</code>
		<p>and try again.</p>
		<br>
		<br>
		<p>That about wraps it up!</p>
		<p>If you have any more questions or if you have any suggestions for either the post, or the script, e-mail me at <a href="mailto:MorgS9@pm.me">MorgS9@pm.me</a>.</p>
		<p>Thanks for reading, Have a good day!</p>
	</body>

</html>
